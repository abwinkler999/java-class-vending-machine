package com.awesomevendingco.vendingmachine;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import org.junit.Before;
import org.junit.Test;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import com.awesomevendingco.vendingmachine.machine.VendingMachine;

public class VendingMachineIntegrationTest {

    private VendingMachine machine;

    @Before
    public void setUp() {
        ApplicationContext context = new ClassPathXmlApplicationContext("context.xml");
        machine = (VendingMachine) context.getBean("machine");
    }

    @Test
    public void it_takes_nickels() {
        machine.insertCoin("NICKEL");
        assertEquals("0.05", machine.getBalance());
    }

    @Test
    public void it_takes_dimes() {
        machine.insertCoin("DIME");
        assertEquals("0.10", machine.getBalance());
    }

    @Test
    public void it_takes_quarters() {
        machine.insertCoin("QUARTER");
        assertEquals("0.25", machine.getBalance());
    }

    @Test
    public void it_does_not_take_pennies() {
        machine.insertCoin("PENNY");
        assertEquals("0.00", machine.getBalance());
        assertTrue(machine.getCoinReturn().contains("PENNY"));
    }

    @Test
    public void it_adds_coins() {
        machine.insertCoin("NICKEL");
        machine.insertCoin("DIME");
        machine.insertCoin("QUARTER");
        assertEquals("0.40", machine.getBalance());
    }

    @Test
    public void it_sells_cola() {
        machine.insertCoin("QUARTER");
        machine.insertCoin("QUARTER");
        machine.insertCoin("QUARTER");
        machine.insertCoin("QUARTER");
        machine.selectProduct("COLA");
    }

}
